val step1 = pricesDB
    .groupBy(window($"timestamp", "1 minute"))
    .agg(avg("askprice"))
    .select("window.start", "avg(askprice)")
    .withColumnRenamed("start", "timestamp")
    .withColumnRenamed("avg(askprice)", "avgaskprice")

val trendPerMin = step1
    .join(step1
        .withColumnRenamed("timestamp", "old_timestamp")
        .withColumnRenamed("avgaskprice", "old_avgaskprice"))
    .filter(expr("old_timestamp = timestamp - interval '1 minute'"))
    .withColumn("trend", $"avgaskprice" >= $"old_avgaskprice")
    .select("timestamp", "trend")


----
SELECT * FROM timescaledb_information.hypertable;